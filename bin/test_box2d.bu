// Box2D Physics Test

require "box2d";
import Box2D;
using Box2D;

print "=== Box2D Physics Test ===";

// Create world with gravity (0, -10)
var world = b2WorldCreate(0, -10);
print "World created: " + world;

// Create ground (static body)
var ground = b2CreateBody(world, b2_staticBody, 0, -10);
print "Ground body created";
b2CreateBoxShape(ground, 50, 1, 0, 0.5, 0);  // wide platform

// Create dynamic box
var box = b2CreateBody(world, b2_dynamicBody, 0, 10);
print "Dynamic box created";
b2CreateBoxShape(box, 1, 1, 1.0, 0.3, 0.2);  // 2x2 box

// Simulation loop
var timeStep = 1.0 / 60.0;
var steps = 120;  // 2 seconds

print "\nSimulating " + steps + " steps...";

for (var i = 0; i < steps; i = i + 1)
{
    b2WorldStep(world, timeStep, 4);

    if (i % 20 == 0)
    {
        var pos = b2BodyGetPosition(box);
        var angle = b2BodyGetAngle(box);
        print "Step " + i + ": pos=(" + pos[0] + ", " + pos[1] + ") angle=" + angle;
    }
}

// Final position
var finalPos = b2BodyGetPosition(box);
print "\nFinal position: (" + finalPos[0] + ", " + finalPos[1] + ")";

// Cleanup
b2DestroyBody(box);
b2DestroyBody(ground);
b2WorldDestroy(world);

print "\n=== Box2D Test Complete ===";
