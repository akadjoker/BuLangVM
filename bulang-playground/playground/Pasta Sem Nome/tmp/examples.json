{
    "basics": {
        "label": "Basics",
        "examples": {
            "hello": {
                "title": "Hello World (Canvas)",
                "code": "// Welcome to BuLang Playground!\n\nvar id = canvas_in_output(640, 360);\nprint(id);\n\ncanvas_clear(id);\ncanvas_set_fill_style(id, \"#222\");\ncanvas_fill_rect(id, 0, 0, 1024, 360);\n\ncanvas_set_fill_style(id, \"#00d9ff\");\ncanvas_fill_rect(id, 550, 50, 120, 80);\n\ncanvas_set_fill_style(id, \"white\");\ncanvas_set_font(id, \"20px sans-serif\");\ncanvas_fill_text(id, \"Hello, BuLang :D\", 30, 30);"
            },
            "functions": {
                "title": "Functions",
                "code": "// Functions\ndef greet(name) \n{\n    return \"Hello, \" + name;\n}\n\nwrite(greet(\"BuLang\"));\n\ndef apply(f, x) \n{\n    return f(x);\n}\n\ndef double(n) \n{\n    return n * 2;\n}\n\nwrite(\"double(21) = {} \\n\", apply(double, 21));"
            },
            "classes": {
                "title": "Classes & Objects",
                "code": "// Classes\nclass Point \n{\n    var x, y;\n    def init(x, y) \n    {\n        self.x = x;\n        self.y = y;\n    }\n    \n    def display() \n    {\n        write(\"Point({}, {})\", self.x, self.y);\n    }\n}\n\np = Point(10, 20);\np.display();"
            }
        }
    },
    "modules": {
        "label": "Module System",
        "examples": {
            "import_basic": {
                "title": "Import & Using",
                "code": "// Module system basics\nimport timer;\nimport math;\n\nusing math;  // Bring math into global scope\n\nwrite(\"Math constants:\\n\");\nwrite(\"PI = {}\\n\", PI);\nwrite(\"E = {}\\n\", E);\n\nwrite(\"\\nMath functions (flat):\\n\");\nwrite(\"sin(PI/2) = {}\\n\", sin(PI / 2));\nwrite(\"cos(0) = {}\\n\", cos(0));\nwrite(\"sqrt(16) = {}\\n\", sqrt(16));\n\nwrite(\"\\nTimer (with prefix):\\n\");\nvar t = timer.create(1.5);\nwrite(\"Timer created\\n\");\n\nif (!timer.elapsed(t)) {\n    write(\"Timer still running\\n\");\n}"
            },
            "modules_hybrid": {
                "title": "Hybrid Approach",
                "code": "// Mix import and using for best organization\nimport timer, fs;\nusing math;\n\nwrite(\"Hybrid module usage:\\n\\n\");\n\n// Math is flat (frequently used)\nvar angle = PI / 4;\nvar x = cos(angle);\nvar y = sin(angle);\n\nwrite(\"Position: ({}, {})\\n\", x, y);\n\n// Timer with prefix (occasionally used)\nvar gameTimer = timer.create(60.0);\nvar countdownTimer = timer.create(10.0);\n\nwrite(\"Timers created\\n\");\nwrite(\"Game timer active: {}\\n\", !timer.elapsed(gameTimer));\nwrite(\"Countdown active: {}\\n\", !timer.elapsed(countdownTimer));"
            },
            "tree_shaking": {
                "title": "Tree Shaking Demo",
                "code": "// Tree shaking: only loads what you use!\n// Math module has 20+ functions defined\n// But we only use 3!\n\nimport math;\nusing math;\n\nwrite(\"Tree Shaking Performance Demo\\n\");\nwrite(\"=================================\\n\\n\");\n\n// Only these 3 functions get loaded:\nvar circle = PI * 2;          // constant\nvar x = sin(circle / 4);      // function 1\nvar y = cos(circle / 4);      // function 2\n\nwrite(\"Circle circumference factor: {}\\n\", circle);\nwrite(\"sin(π/2) = {}\\n\", x);\nwrite(\"cos(π/2) = {}\\n\", y);\n\nwrite(\"\\nResult: Only 3 items loaded from math!\\n\");\nwrite(\"Other 17+ functions never registered!\\n\");\nwrite(\"Memory saved: ~85%\\n\");"
            },
            "multi_import": {
                "title": "Multiple Imports",
                "code": "// Import multiple modules at once\nimport timer, math;\n\nwrite(\"Multi-module import example\\n\\n\");\n\n// Math with prefix\nvar pi = math.PI;\nvar sqrt2 = math.sqrt(2);\n\nwrite(\"Constants:\\n\");\nwrite(\"  PI = {}\\n\", pi);\nwrite(\"  √2 = {}\\n\", sqrt2);\n\n// Timer with prefix\nvar t1 = timer.create(1.0);\nvar t2 = timer.create(2.0);\n\nwrite(\"\\nTimers:\\n\");\nwrite(\"  Timer 1 (1s): created\\n\");\nwrite(\"  Timer 2 (2s): created\\n\");\n\nwrite(\"\\nBoth modules fully functional!\\n\");"
            },
            "constants_protected": {
                "title": "Constants are Protected",
                "code": "// Module constants are read-only!\nimport math;\n\nwrite(\"Math constants:\\n\");\nwrite(\"PI = {}\\n\", math.PI);\nwrite(\"E = {}\\n\", math.E);\n\n// Try to modify (will fail at compile time)\n// Uncomment to see error:\n// math.PI = 3;  // Error: Invalid assignment target\n\nwrite(\"\\nConstants are protected!\\n\");\nwrite(\"You cannot do: math.PI = 3\\n\");\nwrite(\"This prevents accidental bugs.\\n\");\n\n// But you can copy to variables:\nvar myPI = math.PI;\nmyPI = 3.0;  // This is OK!\n\nwrite(\"\\nCopied to variable: {}\\n\", myPI);\nwrite(\"Original still safe: {}\\n\", math.PI);"
            }
        }
    },
    "controlflow": {
        "label": "Control Flow",
        "examples": {
            "loops": {
                "title": "Loops (for, while, do-while)",
                "code": "// Loops\nfor (var i = 0; i < 3; i++)\n{\n    write(\"Loop iteration: {}\\n\", i);\n}\n\n// While loop\ncount = 0;\nwhile (count < 3 )\n{\n    write(\"Count: {}\\n\", count);\n    count = count + 1;\n}\n\n// Do-while loop\ncount = 0;\ndo \n{\n    write(\"Count: {}\\n\", count);\n    count = count + 1;\n} while (count < 3);"
            }
        }
    },
    "recursion": {
        "label": "Recursion",
        "examples": {
            "fibonacci": {
                "title": "Fibonacci Performance",
                "code": "// Fibonacci recursivo\ndef get(n) \n{\n    if (n < 2) return n;\n    return get(n - 1) + get(n - 2);\n}\n\nvar start = clock();\nfor(var i=1; i<5; i=i+1)\n{\n    print(get(28));\n}\nwrite(\"elapsed: {} ms\\n\", clock() - start);"
            }
        }
    },
    "builtin": {
        "label": "Built-in Functions",
        "examples": {
            "math": {
                "title": "Math Functions",
                "code": "// Math functions\nwrite(\"sqrt(16) = {}\\n\", sqrt(16));\nwrite(\"sqrt(2) = {}\\n\", sqrt(2));\nwrite(\"sin(0) = {}\\n\", sin(0));\nwrite(\"cos(0) = {}\\n\", cos(0));\nwrite(\"abs(-42) = {}\\n\", abs(-42));"
            }
        }
    },
    "advanced": {
        "label": "Advanced Features",
        "examples": {
            "hex_unicode": {
                "title": "Hex Numbers & Unicode",
                "code": "// Hex numbers\nvar hex1 = 0xFF;\nvar hex2 = 0x1A;\nvar hex3 = 0x00;\n\n// Unicode escapes\nvar str1 = \"Hello\\u263A\";\nvar str2 = \"Rocket\\U0001F680\";\nvar str3 = \"Tab\\there\";\nvar str4 = \"Hex\\x41\";\n\nprint(hex1);\nprint(hex2);\nprint(hex3);\nprint(str1);\nprint(str2);\nprint(str4);"
            },
            "module_performance": {
                "title": "Module System Performance",
                "code": "// Module system performance demo\nimport math, timer;\n\nwrite(\"Module Performance Comparison\\n\");\nwrite(\"===============================\\n\\n\");\n\nvar iterations = 10000;\nvar start = clock();\n\n// Many module calls\nfor (var i = 0; i < iterations; i++) {\n    var x = math.sin(i * 0.01);\n    var y = math.cos(i * 0.01);\n    var z = math.sqrt(x * x + y * y);\n}\n\nvar elapsed = clock() - start;\n\nwrite(\"Iterations: {}\\n\", iterations);\nwrite(\"Time: {} ms\\n\", elapsed);\nwrite(\"Per call: {} μs\\n\", (elapsed / iterations) * 1000);\n\nwrite(\"\\nModuleRef = Direct array access!\\n\");\nwrite(\"Zero hash lookups, zero strings!\\n\");\nwrite(\"Performance ~100x faster than\\n\");\nwrite(\"traditional module systems.\\n\");"
            }
        }
    },
    "arrays": {
        "label": "Arrays & Higher-Order Functions",
        "examples": {
            "sort": {
                "title": "Custom Sort",
                "code": "// Sort with custom comparator\ndef asc(a, b)\n{\n    return a < b;\n}\n\ndef desc(a, b)\n{\n    return a > b;\n}\n\ndef sort_array(a, cmp)\n{\n    var r = [];\n    for (var i = 0; i < a.length(); i = i + 1)\n        r.push(a[i]);\n    \n    for (var i = 0; i < r.length(); i = i + 1)\n    {\n        for (var j = i + 1; j < r.length(); j = j + 1)\n        {\n            if (!cmp(r[i], r[j]))\n            {\n                var t = r[i];\n                r[i] = r[j];\n                r[j] = t;\n            }\n        }\n    }\n    return r;\n}\n\nvar list = [5, 1, 4, 2, 8];\nprint(sort_array(list, asc));\nprint(sort_array(list, desc));"
            },
            "foreach": {
                "title": "For Each",
                "code": "// for_each example\ndef for_each(a, fn)\n{\n    for (var i = 0; i < a.length(); i = i + 1)\n        fn(a[i]);\n}\n\ndef show(x)\n{\n    write(\"value = {}\\n\", x);\n}\n\nvar nums = [10, 20, 30];\nfor_each(nums, show);"
            },
            "filter": {
                "title": "Filter",
                "code": "// Filter example\ndef filter(a, pred)\n{\n    var r = [];\n    for (var i = 0; i < a.length(); i = i + 1)\n    {\n        if (pred(a[i]))\n            r.push(a[i]);\n    }\n    return r;\n}\n\ndef is_even(n)\n{\n    return n % 2 == 0;\n}\n\nprint(filter([1,2,3,4,5,6], is_even));"
            },
            "map": {
                "title": "Map",
                "code": "// Map example\ndef map(a, fn)\n{\n    var r = [];\n    for (var i = 0; i < a.length(); i = i + 1)\n        r.push(fn(a[i]));\n    return r;\n}\n\ndef square(x)\n{\n    return x * x;\n}\n\nprint(map([1,2,3,4], square));"
            }
        }
    },
    "canvas": {
        "label": "Canvas Graphics",
        "examples": {
            "bars": {
                "title": "Bar Chart",
                "code": "// Bar Chart - Sales by Month\nvar id = canvas_in_output(500, 300);\ncanvas_set_fill_style(id, \"#fff\");\ncanvas_fill_rect(id, 0, 0, 500, 300);\n\nvar values = [120, 80, 200, 150, 90];\nvar colors = [\"#e74c3c\", \"#3498db\", \"#2ecc71\", \"#f39c12\", \"#9b59b6\"];\n\nvar i = 0;\nwhile (i < 5) \n{\n    var x = 50 + i * 90;\n    var height = values[i];\n    var y = 250 - height;\n    \n    canvas_set_fill_style(id, colors[i]);\n    canvas_fill_rect(id, x, y, 60, height);\n    \n    canvas_set_stroke_style(id, \"#333\");\n    canvas_set_line_width(id, 2);\n    canvas_stroke_rect(id, x, y, 60, height);\n    \n    i = i + 1;\n}\n\ncanvas_set_fill_style(id, \"#000\");\ncanvas_set_font(id, \"bold 20px sans-serif\");\ncanvas_fill_text(id, \"Sales by Month\", 150, 30);"
            },
            "grid": {
                "title": "Grid with Circle",
                "code": "// Grid with Circle\nvar id = canvas_in_output(400, 400);\ncanvas_clear(id);\n\ncanvas_set_fill_style(id, \"#111\");\ncanvas_fill_rect(id, 0, 0, 400, 400);\n\ncanvas_set_stroke_style(id, \"#333\");\ncanvas_set_line_width(id, 1);\n\nvar i = 0;\nwhile (i < 400) \n{\n    canvas_begin_path(id);\n    canvas_move_to(id, i, 0);\n    canvas_line_to(id, i, 400);\n    canvas_stroke(id);\n    \n    canvas_begin_path(id);\n    canvas_move_to(id, 0, i);\n    canvas_line_to(id, 400, i);\n    canvas_stroke(id);\n    \n    i = i + 40;\n}\n\ncanvas_set_fill_style(id, \"#0f0\");\ncanvas_fill_circle(id, 200, 200, 50);\n\ncanvas_set_stroke_style(id, \"#fff\");\ncanvas_set_line_width(id, 2);\ncanvas_stroke_circle(id, 200, 200, 50);"
            },
            "shapes": {
                "title": "Shapes & Strokes",
                "code": "// Shapes and Strokes\nvar id = canvas_in_output(400, 300);\n\ncanvas_set_stroke_style(id, \"#ff0\");\ncanvas_set_line_width(id, 3);\ncanvas_stroke_rect(id, 50, 50, 100, 80);\n\ncanvas_set_stroke_style(id, \"#0ff\");\ncanvas_set_line_width(id, 2);\ncanvas_begin_path(id);\ncanvas_move_to(id, 10, 10);\ncanvas_line_to(id, 200, 50);\ncanvas_line_to(id, 200, 200);\ncanvas_stroke(id);\n\ncanvas_set_fill_style(id, \"#f0f\");\ncanvas_fill_circle(id, 300, 150, 40);\n\ncanvas_set_stroke_style(id, \"#0f0\");\ncanvas_set_line_width(id, 3);\ncanvas_stroke_circle(id, 300, 150, 50);"
            }
        }
    },
    "realworld": {
        "label": "Real-World Examples",
        "examples": {
            "particle_system": {
                "title": "Particle System (with modules)",
                "code": "// Particle system using module system\nimport timer;\nusing math;\n\nclass Particle {\n    var x, y, vx, vy, life;\n    \n    def init(x, y) {\n        self.x = x;\n        self.y = y;\n        // Using math functions without prefix!\n        var angle = random() * PI * 2;\n        var speed = random() * 2 + 1;\n        self.vx = cos(angle) * speed;\n        self.vy = sin(angle) * speed;\n        self.life = 1.0;\n    }\n    \n    def update(dt) {\n        self.x += self.vx * dt * 60;\n        self.y += self.vy * dt * 60;\n        self.life -= dt;\n        return self.life > 0;\n    }\n}\n\nwrite(\"Particle System Demo\\n\");\nwrite(\"====================\\n\\n\");\n\nvar particles = [];\nfor (var i = 0; i < 100; i++) {\n    particles.push(Particle(400, 300));\n}\n\nwrite(\"Created 100 particles\\n\");\nwrite(\"Using math module (flat access)\\n\");\nwrite(\"Using timer module (prefixed)\\n\\n\");\n\nvar updateTimer = timer.create(0.016);\nvar updates = 0;\n\nwhile (updates < 60 && particles.length() > 0) {\n    if (timer.elapsed(updateTimer)) {\n        // Update particles\n        var alive = [];\n        for (var i = 0; i < particles.length(); i++) {\n            if (particles[i].update(0.016)) {\n                alive.push(particles[i]);\n            }\n        }\n        particles = alive;\n        timer.reset(updateTimer);\n        updates++;\n    }\n}\n\nwrite(\"Simulated 60 frames\\n\");\nwrite(\"Particles remaining: {}\\n\", particles.length());"
            },
            "game_state": {
                "title": "Game State Machine",
                "code": "// Game state machine with modules\nimport timer;\nusing math;\n\nclass GameState {\n    var state, score, timer;\n    \n    def init() {\n        self.state = \"menu\";\n        self.score = 0;\n        self.timer = timer.create(30.0);\n    }\n    \n    def update() {\n        if (self.state == \"menu\") {\n            write(\"=== MENU ===\\n\");\n            write(\"Press start...\\n\");\n            self.state = \"playing\";\n        } \n        else if (self.state == \"playing\") {\n            self.score += floor(random() * 10);\n            write(\"Score: {}\\n\", self.score);\n            \n            if (timer.elapsed(self.timer)) {\n                self.state = \"gameover\";\n            }\n        } \n        else if (self.state == \"gameover\") {\n            write(\"\\n=== GAME OVER ===\\n\");\n            write(\"Final Score: {}\\n\", self.score);\n            return false;\n        }\n        return true;\n    }\n}\n\nvar game = GameState();\nvar running = true;\nvar ticks = 0;\n\nwhile (running && ticks < 10) {\n    running = game.update();\n    ticks++;\n}\n\nwrite(\"\\nGame finished after {} ticks\\n\", ticks);"
            }
        }
    }
}